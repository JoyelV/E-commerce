<!DOCTYPE HTML>
<html lang="en">

<head>
    <meta charset="utf-8">
    <title>MOMENT Dashboard</title>
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta property="og:title" content="">
    <meta property="og:type" content="">
    <meta property="og:url" content="">
    <meta property="og:image" content="">
    <!-- Favicon -->
    <link rel="shortcut icon" type="image/x-icon" href="/adminassets/imgs/theme/favicon.svg">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css"
        integrity="sha512-..." crossorigin="anonymous" />

    <!-- Template CSS -->
    <link href="/adminassets/css/main.css" rel="stylesheet" type="text/css" />

    <style>
        .total-store-value-text {
            font-size: 20px;
            text-transform: uppercase;
        }

        .total-store-value-value {
            font-size: 24px;
        }

        .border-bottom-bold {
            border-bottom: 1px solid #e12020;
        }
    </style>

</head>

<body>
    <div class="screen-overlay"></div>

    <aside class="navbar-aside" id="offcanvas_aside">
        <div class="aside-top">
            <a href="index.html" class="brand-wrap">
                <img src="/adminassets/imgs/brands/7d02989082b082e58141cce8a7536ee3.jpg" class="logo" width="150px"
                    height="auto" display="block" margin="0 auto" alt="Moment Dashboard">
                <h4 style="color: black;">Watch Store</h4>
            </a>
            <div>
                <button class="btn btn-icon btn-aside-minimize"> <i class="text-muted material-icons md-menu_open"></i>
                </button>
            </div>
        </div>
        <nav>
            <ul class="menu-aside">
                <li class="menu-item">
                    <a class="menu-link" href="/admin/dashboard">
                        <i class="icon material-icons md-perm_identity"></i>
                        <span class="text">Dashboard</span>
                    </a>
                </li>
                <li class="menu-item">
                    <a class="menu-link" href="/admin/customers">
                        <i class="icon material-icons md-person"></i>
                        <span class="text">Users</span>
                    </a>
                </li>
                <li class="menu-item">
                    <a class="menu-link" href="/admin/categories">
                        <i class="icon material-icons md-star"></i>
                        <span class="text">Categories</span>
                    </a>
                </li>
                <li class="menu-item">
                    <a class="menu-link" href="/admin/products">
                        <i class="icon material-icons md-shopping_bag"></i>
                        <span class="text">Products</span>
                    </a>
                </li>
                <li class="menu-item">
                    <a class="menu-link" href="/admin/orders">
                        <i class="icon material-icons md-menu"></i>
                        <span class="text">Orders</span>
                    </a>
                </li>
                <li class="menu-item active">
                    <a class="menu-link" href="/admin/stocks">
                        <i class="icon material-icons md-apps"></i>
                        <span class="text">Inventory</span>
                    </a>
                </li>
                <li class="menu-item">
                    <a class="menu-link" href="/admin/coupons">
                        <i class="icon material-icons md-apps"></i>
                        <span class="text">Coupon</span>
                    </a>
                </li>
                <li class="menu-item has-submenu">
                    <a class="menu-link" href="page-transactions-1.html"> <i
                            class="icon material-icons md-local_offer"></i>
                        <span class="text">Offers</span>
                    </a>
                    <div class="submenu">
                        <a href="/admin/category-offers">Category offer</a>
                        <a href="/admin/product-offers">Product offer</a>
                    </div>
                </li>
                <li class="menu-item ">
                    <a class="menu-link" href="/admin/sales-reports"> <i class="icon material-icons md-assessment"></i>
                        <span class="text">Sales Report</span>
                    </a>

                </li>
                <li class="menu-item">
                    <a class="menu-link" href="/admin/logout">
                        <i class="icon material-icons md-exit_to_app"></i>
                        <span class="text">Logout</span>
                    </a>
                </li>
            </ul>
        </nav>
    </aside>
    <main class="main-wrap">
        <header class="main-header navbar">
            <div class="col-search">

            </div>

        </header>

        <section class="content-main">
            <div class="row mb-3">
                <div class="col-lg-3">
                    <button class="btn btn-info"><i class="fas fa-cubes"></i> Total Products: <%= product.length %>
                            </button>
                </div>
                <div class="col-lg-3">
                    <% let totalStoreValue=product.reduce((total, item)=> total + (item.countInStock *
                        item.discountPrice), 0); %>
                        <button class="btn btn-success">Total Store Value: <i class="fas">&#x20B9;</i>
                            <%= totalStoreValue.toFixed(2) %>
                        </button>
                </div>
                <div class="col-lg-3">
                    <% let outOfStockCount=product.filter(item=> item.countInStock === 0).length; %>
                        <button class="btn btn-danger"><i class="fas fa-exclamation-triangle"></i> Out of Stock: <%=
                                outOfStockCount %></button>
                </div>
                <div class="col-lg-3">
                    <button class="btn btn-warning"><i class="fas fa-list"></i> Total Categories: <%= category.length %>
                            </button>
                </div>
            </div>
            <h1>STOCK LIST</h1>
            <form action="/admin/stocks/search?page=<%= currentPage %>&q=<%= query %>"" method=" GET" class="mb-4">
                <div class="input-group">
                    <input type="search" class="form-control" style="border: solid 1px;"
                        placeholder="Enter product name or brand name " name="q">
                    <div class="input-group-append">
                        <button type="submit" class="btn btn-lg btn-primary" style="height: 45px;">Search</button>
                    </div>
                </div>
            </form>
            <div class="table-responsive">
                <table class="table table-hover">
                    <form action="/admin/stocks/update" method="POST">
                        <thead class="table-dark">
                            <tr>
                                <th>Serial No.</th>
                                <th>Product Name</th>
                                <th>Category</th>
                                <th>Brand</th>
                                <th>Stock In</th>
                                <th>Update Quantity</th>
                                <th>Update Quantity</th>
                                <th>Unit Price</th>
                                <th>Total Price</th>
                            </tr>
                        </thead>
                        <tbody>
                            <% let serialNumber=1; %>
                                <% product.forEach((item)=> { %>
                                    <tr>
                                        <td>
                                            <%= serialNumber %>
                                        </td>
                                        <td>
                                            <%= item.name %>
                                        </td>
                                        <td>
                                            <%= item.category.name %>
                                        </td>
                                        <td>
                                            <%= item.brand %>
                                        </td>
                                        <td>
                                            <%= item.countInStock %>
                                        </td>
                                        <td><input type="number" value="<%= item.countInStock %>" name="<%= item._id %>"
                                                min="0" max="100"></td>
                                        <td><button type="submit" class="btn-primary update-button">
                                                <i class="fas fa-sync-alt"></i></button></td>
                                        <td>
                                            <%= item.discountPrice %>
                                        </td>
                                        <td>
                                            <%= item.countInStock * item.discountPrice %>
                                        </td>
                                    </tr>
                                    <tr class="border-bottom-bold"></tr>
                                    <% serialNumber++; %>
                                        <% }); %>
                        </tbody>
                    </form>
                </table>
                <!-- Pagination starts -->
                <div class="pagination">
                    <% if (currentPage> 1) { %>
                        <a href="/admin/stocks?page=<%= currentPage - 1 %>&q=<%= query %>"
                            class="page-link">Previous</a>
                        <% } %>

                            <% for (let i=1; i <=totalPages; i++) { %>
                                <a href="/admin/stocks?page=<%= i %>&q=<%= query %>"
                                    class="page-link <%= currentPage === i ? 'active' : '' %>">
                                    <%= i %>
                                </a>
                                <% } %>

                                    <% if (currentPage < totalPages) { %>
                                        <a href="/admin/stocks?page=<%= currentPage + 1 %>&q=<%= query %>"
                                            class="page-link">Next</a>
                                        <% } %>
                </div>
                <!-- Pagination ends -->
            </div>
            <div class="row mt-3">
                <div class="col-lg-12">
                    <div
                        class="total-store-value-container p-3 bg-dark text-white d-flex justify-content-between align-items-center">
                        <div class="total-store-value-text">
                            <span style="font-size: 20px; text-transform: uppercase;">Total Store Value</span>
                        </div>
                        <div class="total-store-value-value">
                            <span style="font-size: 24px;">
                                <%= totalStoreValue.toFixed(2) %>
                            </span>
                        </div>
                    </div>
                </div>
            </div>
        </section>
        <footer class="main-footer font-xs">
            <div class="row pb-30 pt-15">
                <div class="col-sm-6">
                    <script>
                        document.write(new Date().getFullYear())
                    </script> Â©, Evara - HTML Ecommerce Template .
                </div>
                <div class="col-sm-6">
                    <div class="text-sm-end">
                        All rights reserved
                    </div>
                </div>
            </div>
        </footer>
    </main>
    <script src="adminassets/js/vendors/jquery-3.6.0.min.js"></script>
    <script src="adminassets/js/vendors/bootstrap.bundle.min.js"></script>
    <script src="adminassets/js/vendors/select2.min.js"></script>
    <script src="adminassets/js/vendors/perfect-scrollbar.js"></script>
    <script src="adminassets/js/vendors/jquery.fullscreen.min.js"></script>
    <!-- Main Script -->
    <script src="adminassets/js/main.js" type="text/javascript"></script>
</body>

</html>